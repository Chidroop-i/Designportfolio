window.Proofing_Store = {
  galleryCart          : '.js-gal-cart',
  favGalleryCart       : '.js-fav-gal-cart',
  addPhoto             : '.js-add-photo',
  floatingCartOverlay  : '.js-proofing-fc-overlay',
  floatingCartBlock    : '.js-proofing-fc-block',
  floatingCartClose    : '.js-proofing-fc-close',
  cartItemRemove       : '.js-cart-item-remove',
  floatingCartBtn      : '.js-floating-pcart',
  insideCartQuantity   : '.js-inside-cart-quantity',
  checkoutForm         : '.js-pcheckout-form',
  cropImageBtn         : '.js-crop-image',
  cropImageCloseBtn    : '.js-image-crop-close-btn',
  cropImage            : '.js-image-crop-overlay',
  cropCartUpdate       : '.js-update-cart-img-coordinates',
}

Proofing_Store.proofingFullGalleryStoreItemQuantity = function () {
  $.each($('.js-fullgallery-cartitems'), function( key, value ) {
    // console.log("value--" , value);
    var qty = '.js-fullgallery-'+$(value).data('galleryid')+'-'+$(value).data('fullgalleryoptionid');
    // console.log("qty - ", qty);
    $(qty).attr('data-quantity', $(value).data('quantity'));
    $(qty).attr('data-fullgalleryoptionid', $(value).data('fullgalleryoptionid'));
    $(qty).attr('data-fullgalleryimageid', $(value).data('imageid'));

    // var galleryclass = $(value).attr('data-galleryclass');    
    // console.log("galleryclass--" , galleryclass);

    // var galleryid = $(value).attr('data-galleryid');
    // console.log("galleryid--" , galleryid);
    
    // $.each($(".js-gal-cart-option").hasClass($(value).attr('data-galleryclass')), function( key, value ) {
    //   $(this).attr('data-quantity', '1');
    // });

    // $(galleryclass).attr('data-quantity', '1');

    // $('.js-fullgallery-'+galleryid).attr('data-quantity', $(value).data('quantity'));
  });
}

Proofing_Store.proofingStoreItemQuantity = function () {
  $.each($('.js-gal-cart-ref'), function( key, value ) {
    var s = '.js-'+$(value).data('imageid')+'-'+$(value).data('optionid');
    // console.log("quantity " + s);
    $(s).attr('data-quantity', $(value).data('quantity'));
  });
}


Proofing_Store.Init = function() {

  Proofing_Store.cropModalInit();

  $(function(){
    Proofing_Store.jCropint(this);
  });

  
  
  Proofing_Store.proofingStoreItemQuantity(); 

  Proofing_Store.proofingFullGalleryStoreItemQuantity();



  var csrf_token, photoid, temp, temp1, image, title, quantity, price,
   counter, currency, itemId, gallerySlug, sampleText, type, itemadded,
    itemremove, crop_data, catalogid, printable, appendfavimg, notytitle, galleryid;
  csrf_token = $('#csrf_token').val();


  $('body').on('click', Proofing_Store.addPhoto, function (event) {
    $('.js-proofing-fc-loading').show();
    if( $(this).data('pagetype') == 'fav-page' )
      gallerySlug = $(this).data('linkslug');
    else
      gallerySlug = $('.js-price-list-body').attr('data-linkslug');

    
    galleryid = $('.js-price-list-img').attr('data-galleryid');
    image = $('.js-price-list-img img').attr('src');
    currency = $('.js-global-currency').val();
    itemadded = $('.js-price-list-body').data('itemadded');
    itemremove = $('.js-price-list-body').data('itemremove');
    crop_data = $(this).parent().find('span');
    label_id = $(this).data('labelid');
    downloadtype = $(this).data('downloadtype');
    // console.log("label_id" + galleryid + label_id);
    temp2 = '.js-add-fullgallery-'+galleryid+"-"+label_id;
    // console.log("temp2--" + temp2);

    appendfavimg = '<div class="js-favimg-noty favimg-noty"><img src="'+image+'"></div>';

    var data_x, data_y, data_h, data_w, data_oh, data_ow, priority, aspx, aspy;
    // data_x = parseInt(crop_data.attr('data-x')!="undefined"?crop_data.attr('data-x'):-1);
    // data_y = parseInt(crop_data.attr('data-y')!="undefined"?crop_data.attr('data-y'):-1);
    // data_h = parseInt(crop_data.attr('data-h')!="undefined"?crop_data.attr('data-h'):-1);
    // data_w = parseInt(crop_data.attr('data-w')!="undefined"?crop_data.attr('data-w'):-1);
    // data_oh = parseInt(crop_data.attr('data-oh')!="undefined"?crop_data.attr('data-oh'):-1);
    // data_ow = parseInt(crop_data.attr('data-ow')!="undefined"?crop_data.attr('data-ow'):-1);

    // aspx = crop_data.attr('data-aspx') != "undefined" ? crop_data.attr('data-aspx') : -1;
    // aspy = crop_data.attr('data-aspy') != "undefined" ? crop_data.attr('data-aspy') : -1;


    spanCount = parseInt($(this).siblings('span').text());
    price = $(this).data('price');
    title = $(this).data('title');
    // labelid = $(this).data('labelid');
    catalogid = $(this).data('labcatalogid');
    printable = $(this).attr('data-printable');
    type = $(this).data('type');

    // console.log('full id ', $(temp2).attr('data-fullgalleryoptionid'));

    if( downloadtype == 2 && !($(temp2).attr('data-fullgalleryoptionid') == '' || $(temp2).attr('data-fullgalleryoptionid') == 0)) {
      labelid = $(temp2).attr('data-fullgalleryoptionid');
      photoid = $(temp2).attr('data-fullgalleryimageid');
      // console.log("typeof enter-- " , type)
    } else {
      labelid = $(this).data('labelid');
      photoid = $('.js-price-list-img').attr('data-imageid');
      // console.log("typeof note enter-- " , type)
    }

    appendfavimg = '<div class="js-favimg-noty favimg-noty left"><img src="'+image+'"></div>';
    notytitle = '<div class="js-favimg-title noty-favimg-title">'+title+'</div>';

    if( type == 2 ) {
      if( $(this).hasClass('plus-icon') ) {
        if( spanCount+1 >= 2) {
          $('.js-proofing-fc-loading').hide();
          sweetAlert((typeof window.labels != 'undefined' ? window.labels.store_cart_item_quantity_zero : "Oops..."), (typeof window.labels != 'undefined' ? window.labels.store_cart_digital_warning : "This digital item is already in your cart!"), "error");
          return false;
          return false;
        }
        quantity = 1;
        sampleText = itemadded;
        $(this).siblings('span').text(1);
      } else {

        if( spanCount-1 < 0) {
          $('.js-proofing-fc-loading').hide();
          sweetAlert((typeof window.labels != 'undefined' ? window.labels.store_cart_item_quantity_zero : "Oops..."), (typeof window.labels != 'undefined' ? window.labels.store_cart_item_quantity_cannot_zero : "Quantity cannot be zero!"), "error");
          return false;
        } else {
          quantity = 0;
          sampleText = itemremove;
          $(this).siblings('span').text(0);
        }
      }
    } else {
      if( $(this).hasClass('plus-icon') ) {
        $(this).siblings('span').text(spanCount+1);
        quantity = spanCount+1;
        sampleText = itemadded;
      } else {
        if( (spanCount-1) < 0 ) {
          $('.js-proofing-fc-loading').hide();
          sweetAlert((typeof window.labels != 'undefined' ? window.labels.store_cart_item_quantity_zero : "Oops..."), (typeof window.labels != 'undefined' ? window.labels.store_cart_item_quantity_cannot_zero : "Quantity cannot be zero!"), "error");
          return false;
        } else {
          $(this).siblings('span').text(spanCount-1);
          quantity = spanCount-1;
        }
        sampleText = itemremove;
      }
    }

    temp1 = '.js-'+$('.js-price-list-img').attr('data-imageid')+'-'+labelid;
    // console.log("temp 1--" + '.js-'+$('.js-price-list-img').attr('data-imageid')+'-'+labelid);    
    $(temp1).attr('data-quantity', quantity);

    
    
    $(temp2).attr('data-quantity', quantity);
    if (downloadtype == 2) {
      // console.log("prnce 1");
      if (quantity == 1) {
        $(temp2).attr('data-fullgalleryoptionid', labelid);
        $(temp2).attr('data-fullgalleryimageid', photoid);
        // console.log("prnce 2");
      } else{
        $(temp2).attr('data-fullgalleryoptionid', '0');
        $(temp2).attr('data-fullgalleryimageid', '0');
        // console.log("prnce 3");
      }
    }
    
    

    // $.each($('.js-fullgallery-'+galleryid), function( key, value ) {
    //   $(this).attr('data-quantity', quantity);
    // });

    //==================
    temp = $("#cart-item-template").html();
    temp = $(temp)[0];
    $(temp).attr('data-optionlabel', labelid);
    $(temp).attr('data-productid', photoid);
    $(temp).find('.cart-item-image').attr('src', image);
    $(temp).find('.cart-item-title').html(title);
    $(temp).find('.cart-item-label').hide();
    $(temp).find('.cart-item-unitprice').html(currency+price);
    $(temp).find('.cart-item-quantity').val(quantity);
    $(temp).find('.cart-item-quantity').attr('data-prevvalue', quantity);
    $(temp).find('.cart-item-quantity').attr('data-title', title);
    $(temp).find('.cart-item-quantity').attr('data-maxlimit', $('.js-quantity').attr('max'));
    $(temp).find('.cart-item-quantity').attr('data-type', type);
    $(temp).find('.cart-item-price').html(currency+''+price*quantity);
    // $(temp).find(Proofing_Store.cropImageBtn).attr('data-x',data_x);
    // $(temp).find(Proofing_Store.cropImageBtn).attr('data-y',data_y);
    // $(temp).find(Proofing_Store.cropImageBtn).attr('data-h',data_h);
    // $(temp).find(Proofing_Store.cropImageBtn).attr('data-w',data_w);
    // $(temp).find(Proofing_Store.cropImageBtn).attr('data-oh',data_oh);
    // $(temp).find(Proofing_Store.cropImageBtn).attr('data-ow',data_ow);
    // $(temp).find(Proofing_Store.cropImageBtn).attr('data-aspx',aspx);
    // $(temp).find(Proofing_Store.cropImageBtn).attr('data-aspy',aspy);


    // if (printable != 0) {
    //   $(temp).find('.jcrop-img-view').attr('data-x',data_x);
    //   $(temp).find('.jcrop-img-view').attr('data-y',data_y);
    //   $(temp).find('.jcrop-img-view').attr('data-h',data_h);
    //   $(temp).find('.jcrop-img-view').attr('data-w',data_w);
    //   $(temp).find('.jcrop-img-view').attr('data-oh',data_oh);
    //   $(temp).find('.jcrop-img-view').attr('data-ow',data_ow);
    //   $(temp).find('.jcrop-img-view').attr('data-aspx',aspx);
    //   $(temp).find('.jcrop-img-view').attr('data-aspy',aspy);


    //   $(function(){
    //     $(temp).find('.jcrop-img-view img').Jcrop({
    //       bgColor:     'black',
    //       bgOpacity:   .4,
    //       setSelect:   [ data_x, data_y, data_h, data_w ],
    //       aspectRatio: aspx / aspy,
    //       allowResize : false,
    //       allowSelect : false,
    //       boxWidth: 70, boxHeight: 105,
    //       trueSize: [data_w,data_h]
    //     });
    //   });
    // }



    // if( catalogid < 0 ) {
    //   $(temp).find(Proofing_Store.cropImageBtn).remove();
    // }

    if (printable == 0) {
      $(temp).find(Proofing_Store.cropImageBtn).remove();
      $(temp).find('.crop-image-view').removeClass('jcrop-img-view');
    }

    //==================

    (function(templ) {
      $.ajax({
        type: 'POST',
        url: $('.js-price-list-body').data('requestslug')+'?_token='+ csrf_token,
        data: {
          'id': photoid,
          'option': labelid,
          'quantity': quantity,
          'gallery-slug' : gallerySlug,
          'lab_catalog_id' : catalogid,
          // 'data_x': data_x,
          // 'data_y': data_y,
          // 'data_h': data_h,
          // 'data_w': data_w,
          // 'data_oh': data_oh,
          // 'data_ow': data_ow,
          // 'print_width': aspx,
          // 'print_height': aspy,
        }
      })
      .done(function(data) {
        // console.log(data);


        $(temp).find(Proofing_Store.cropImageBtn).attr('data-x',data.x);
        $(temp).find(Proofing_Store.cropImageBtn).attr('data-y',data.y);
        $(temp).find(Proofing_Store.cropImageBtn).attr('data-h',data.h);
        $(temp).find(Proofing_Store.cropImageBtn).attr('data-w',data.w);
        $(temp).find(Proofing_Store.cropImageBtn).attr('data-oh',data.oh);
        $(temp).find(Proofing_Store.cropImageBtn).attr('data-ow',data.ow);
        $(temp).find(Proofing_Store.cropImageBtn).attr('data-aspx',data.aspx);
        $(temp).find(Proofing_Store.cropImageBtn).attr('data-aspy',data.aspy);


        if (printable != 0) {
          $(temp).find('.jcrop-img-view').attr('data-x',data.x);
          $(temp).find('.jcrop-img-view').attr('data-y',data.y);
          $(temp).find('.jcrop-img-view').attr('data-h',data.h);
          $(temp).find('.jcrop-img-view').attr('data-w',data.w);
          $(temp).find('.jcrop-img-view').attr('data-oh',data.oh);
          $(temp).find('.jcrop-img-view').attr('data-ow',data.ow);
          $(temp).find('.jcrop-img-view').attr('data-aspx',data.aspx);
          $(temp).find('.jcrop-img-view').attr('data-aspy',data.aspy);


          $(function(){
            $(temp).find('.jcrop-img-view img').Jcrop({
              bgColor:     'black',
              bgOpacity:   .4,
              setSelect:   [ data.x, data.y, data.h, data.w ],
              aspectRatio: data.aspx / data.aspy,
              allowResize : false,
              allowSelect : false,
              boxWidth: 70, boxHeight: 105,
              trueSize: [data.w,data.h]
            });
          });
        }




        $('.js-proofing-fc-loading').hide();
        if(photoid == data.productId)
          Proofing_Store.AddNewItem(templ);  
        $('.js-ptotal-amount').html(data.totalPrice);
        $('.js-pcart-quantity').text(data.quantity);

        if( data.quantity == 0) {
          $('.js-floating-pcart-empty').show();
          $(Proofing_Store.floatingCartBtn).addClass('cart-not-active');
          $('.js-pcheckout-container').hide();
        } else {
          $('.js-floating-pcart-empty').hide();
          $('.js-pcheckout-container').show();
          $(Proofing_Store.floatingCartBtn).removeClass('cart-not-active');
          $('.js-proofing-header-cart').addClass('favourite-count-active');
        }

        if( data.quantity == 0) {
          $('.js-floating-cart-empty').show();
          $('.js-checkout-container').hide();
          $('.js-floating-cart').addClass('cart-not-active');
        }

        if( data.cartImages[photoid] != undefined ) {
          $($('.js-slideshowgal-cart')[window.slideIndex]).addClass('favourite-info-active');
          $(".shopping-cart-show[data-imageid='"+photoid+"']").css("opacity", "1");
          $(".shopping-cart-show[data-imageid='"+photoid+"']").addClass("shopping-cart-active");
        } else {
          $(".shopping-cart-show[data-imageid='"+photoid+"']").css("opacity", "0");
          $(".shopping-cart-show[data-imageid='"+photoid+"']").removeClass("shopping-cart-active");
          $($('.js-slideshowgal-cart')[window.slideIndex]).removeClass('favourite-info-active');
        }

        if( parseInt(data.totalPrice) >= parseInt($('.js-price-list-body').attr('data-mincartprice')) ) {
          $(Proofing_Store.checkoutForm).show().removeClass('hide-all');
          $('.js-mincart-error').hide().addClass('hide-all');
        } else {
          $('.js-mincart-error').show().removeClass('hide-all');
          $(Proofing_Store.checkoutForm).hide().addClass('hide-all');
        }
        $.each($('.js-cart-item-list'), function( key, value ) {
          if( data.productId == $(value).attr('data-productid') && data.optionId == $(value).attr('data-optionlabel')) {
            $(value).find(Proofing_Store.cartItemRemove).attr('data-itemid', data.itemId);
            $(value).find(Proofing_Store.insideCartQuantity).attr('data-itemid', data.itemId);
          }
        });
      });
    })(temp);

    Proofing_Store.AddNewItem = function(tmpl) {

      if($('.js-cart-item-list').length != 0) {
        $.each($('.js-cart-item-list'), function( key, value ) {
          if( $(value).attr('data-productid') == photoid && $(value).attr('data-optionlabel') == labelid) {
            $(value).remove();
            counter = 1;
          } else {
            counter = 1;
          }
        });
      } else {
        $('.js-pcart-item-container').append(tmpl);
      }

      if(counter == 1) {
        $('.js-pcart-item-container').append(tmpl);
      }


      $.each($('.js-cart-item-list'), function( key, value ) {
      if( $(value).find(Proofing_Store.insideCartQuantity).val() == 0 || $(value).find(Proofing_Store.insideCartQuantity).val() == '')
        $(value).remove();
      });

      var n = noty($.extend({
        text        : sampleText,
        type        : 'success',
        template    : '<div class="noty_message text-left left">'+appendfavimg+notytitle+'<span class="noty_text before-none"></span><div class="noty_close"></div></div>',
        timeout     :  4000,
      }, window.notyDefaults));

      Proofing_Store.cropModalInit();

      // $(function(){
      //   Proofing_Store.jCropint(this);
      // });

    }
  });

  $('body').on('change', Proofing_Store.insideCartQuantity, function (event) {
    var prev, quan = $(this).val();

    if( quan <= 0) {
      sweetAlert((typeof window.labels != 'undefined' ? window.labels.store_cart_item_quantity_zero : "Oops..."), (typeof window.labels != 'undefined' ? window.labels.store_cart_item_quantity_cannot_zero : "Quantity cannot be zero!"), "error");
      $(this).val($(this).attr('data-prevvalue'));
      quan = $(this).attr('data-prevvalue');
    } else if( !Number.isInteger(parseFloat(quan)) || $(this).attr('data-type') == 2 ) {
      quan = 1;
      $(this).val(1);
    }

    itemId = $(this).data('itemid');
    var $that = $(this);

    temp1 = '.js-'+$that.parents('.js-cart-item-list').attr('data-productid')+'-'+$that.parents('.js-cart-item-list').attr('data-optionlabel');
    $(temp1).attr('data-quantity', quan);

    // console.log(quan);
    // console.log(itemId)

    $.ajax({
        type: 'POST',
        url: '/site/floating-quantity/' + itemId +'?_token='+ csrf_token,
        data: {
          'quantity': quan,
          'client-slug': $('.js-price-list-body').attr('data-clientslug'),
        },
      })
    .done(function(data) {
      // console.log(data);
      $that.siblings('.js-cart-item-price').html($('.js-global-currency').val()+data.product_total);
      $('.js-ptotal-amount').html(data.totalPrice);
      $('.js-pcart-quantity').text(data.quantity);

      if( parseInt(data.totalPrice) >= parseInt($('.js-price-list-body').attr('data-mincartprice')) ) {
        $(Proofing_Store.checkoutForm).show().removeClass('hide-all');
        $('.js-mincart-error').hide().addClass('hide-all');
      } else {
        $('.js-mincart-error').show().removeClass('hide-all');
        $(Proofing_Store.checkoutForm).hide().addClass('hide-all');
      }

    });
  });

  $('body').on('click', Proofing_Store.cartItemRemove, function (event) {
    itemId = $(this).data('itemid');
    var $that = $(this);

    swal({
      title: $('.js-price-list-body').data('willremoved'),
      text: "",
      type: "warning",
      showCancelButton: true,
      confirmButtonColor: "#DD6B55",
      confirmButtonText: (typeof window.labels != 'undefined' ? window.labels.store_cart_confirm_remove : "Yes, remove it"),
      cancelButtonText: (typeof window.labels != 'undefined' ? window.labels.store_cart_cancel_button : "Cancel"),
      closeOnConfirm: true,
      closeOnCancel: false,
      allowOutsideClick: true,
      showLoaderOnConfirm: true,
    }, function (isConfirm) {
      if(isConfirm) {
        $('button.confirm').attr('disabled', true);
        $.ajax({
            type: 'POST',
            url: '/site/floating-remove-item/' + itemId +'?_token='+ csrf_token,
          })
        .done(function(data) {
          // console.log(data);
          // swal((typeof window.labels != 'undefined' ? window.labels.store_cart_itemdeleted : "Deleted!"), $('.js-price-list-body').data('itemremove'), "success");
          $('button.confirm').attr('disabled', false);
          $that.parents('.js-cart-item-list').remove();

          $('.js-ptotal-amount').html(data.totalPrice);
          $('.js-pcart-quantity').text(data.quantity);
          var photoid = $that.parents('.js-cart-item-list').attr('data-productid');
          if( data.cartImages[$that.parents('.js-cart-item-list').attr('data-productid')] != undefined )
            $($('.js-slideshowgal-cart')[window.slideIndex]).addClass('favourite-info-active');
          else
            $($('.js-slideshowgal-cart')[window.slideIndex]).removeClass('favourite-info-active');

          if( parseInt(data.totalPrice) >= parseInt($('.js-price-list-body').attr('data-mincartprice')) ) {
            $(Proofing_Store.checkoutForm).show().removeClass('hide-all');
            $('.js-mincart-error').hide().addClass('hide-all');
          } else {
            $('.js-mincart-error').show().removeClass('hide-all');
            $(Proofing_Store.checkoutForm).hide().addClass('hide-all');
          }

          temp1 = '.js-'+$that.parents('.js-cart-item-list').attr('data-productid')+'-'+$that.parents('.js-cart-item-list').attr('data-optionlabel');
          $(temp1).attr('data-quantity', 0);

          if( data.quantity == 0) {
            $('.js-floating-pcart-empty').show();
            $('.js-pcheckout-container').hide();
            $(".shopping-cart-show[data-imageid='"+photoid+"']").css("opacity", "0");
            $(Proofing_Store.floatingCartBtn).addClass('cart-not-active');
          }

        });
      } else {
        swal((typeof window.labels != 'undefined' ? window.labels.store_cart_cancelled : "Cancelled"), (typeof window.labels != 'undefined' ? window.labels.store_cart_still_in_cart : "Item is still in cart :)"), "error");
        $('button.confirm').attr('disabled', false);
      }
    });

  });

  $('body').on('click', Proofing_Store.galleryCart, function (event) {
    event.stopPropagation();
    $('body').addClass('no-scroll');
    $('.js-price-list-body').show();
    $('.js-pcart-item-wrapper').hide();
    $('.js-price-list-img').attr('data-imageid', $(this).attr('data-imageid'));
    $('.js-price-list-img').attr('data-galleryid', $(this).attr('data-galleryid'));
    $('.js-price-list-img img').attr('src', $(this).attr('data-smallscreen'));
    var original_height = $("[data-gridimageid='"+$(this).data('imageid')+"']").attr("data-height");
    var original_width = $("[data-gridimageid='"+$(this).data('imageid')+"']").attr("data-width");
    var height500 = $("[data-gridimageid='"+$(this).data('imageid')+"']").attr("data-height500");
    var width500 = $("[data-gridimageid='"+$(this).data('imageid')+"']").attr("data-width500");
    var h = height500;
    var w = width500;
    var as;

    if (typeof h == 'undefined' || typeof w == 'undefined' || typeof h == '' || typeof w == '') {
      if (typeof original_height != 'undefined' && typeof original_width != 'undefined') {
        w = original_width;
        h = original_height;
        
        newUnit   = 500;
        if ($(this).attr('data-jcropnewimg') == "1") {
          newUnit   = 500;  
        } else{
          newUnit   = 400;
        }
        
        if ( w <= newUnit && h <= newUnit) {
        } else {
          
          if (newUnit == 500) {
            if (w > newUnit) {
              w     =   newUnit;
              h    =  Math.round((newUnit*original_height)/original_width);
            }
          } else {
            if (w > newUnit) {
              w     =   newUnit;
              h    =  Math.round((newUnit*original_height)/original_width);
            }
          }

        }
      }
    }

    // console.log('height: '+h+'width: '+w + ' newUnit:' + newUnit);
    // console.log('height: '+h+'width: '+w);

    $.each($('.js-photono-'+$(this).attr('data-imageid')), function( key, value ) {
      $that = $(value);
      $.each($('.js-table-tr'), function( key, value ) {
        if( $that.attr('data-optionid') == $(value).attr('data-labelid') ) {
          $(value).find('span').text($that.attr('data-quantity'));
        //=================== function to check if image has jcrop compatible aspect ratio
        //width, height, aspect ratio
        // if( $(this).attr('data-labcatlogid') != 0 ) {
        if( $(this).attr('data-labcatlogid') >= 0 && $(value).attr('data-download') == 0 ) {
          var div = $(value).find('.label-v');
          as = "";
          if( parseFloat($(div).attr("data-height")) > 0 && parseFloat($(div).attr("data-width")) > 0 ) {
            as = $(div).attr("data-width") +" x "+$(div).attr("data-height");
          } else {
            as = $(value).find('.label-v').text();
            if( as.indexOf('8 Up Wallet') !== -1 )
              as = "2.5 x 3.5";
          }
          // console.log("Aspect ratio: "+as);
          var res = checkAspectRatio(original_height, original_width, w, h, as);
          if(res.status) {
            $(value).show();
          } else {
            if ($that.attr('data-photocheck') == 'js-check-printable-size') {
              $(value).hide();
            }
          }
          // $(value).find('span').attr('data-x', res.x);
          // $(value).find('span').attr('data-y', res.y);
          // $(value).find('span').attr('data-h', res.h);
          // $(value).find('span').attr('data-w', res.w);
          // $(value).find('span').attr('data-oh', res.oh);
          // $(value).find('span').attr('data-ow', res.ow);
          // $(value).find('span').attr('data-aspx', res.aspx);
          // $(value).find('span').attr('data-aspy', res.aspy);
        }
        //=================== End
        }
      });
      // code to hide/show table headings
      $(".js-table-container").each(function(i, v){
        if($(v).find('.js-table-tr').is(':visible')) {
          $(v).find('.tr-heading').show();

          // prince code start
          var proid = $(v).find('.tr-heading').find('.label-v').attr('id');
          $(".proofing-category").find('.data-target').each(function() {
            if ($(this).attr('data-id') == proid) {
              $(this).show();
            }
          });


        } else {
          $(v).find('.tr-heading').hide();

          // price code start
          var proid = $(v).find('.tr-heading').find('.label-v').attr('id');
          $(".proofing-category").find('.data-target').each(function() {
            if ($(this).attr('data-id') == proid) {
              $(this).hide();
            }
          });          
        }

        
      });

      if($('.js-table-tr').is(':visible')) {
        $(".js-options-not-found").hide();
      } else {
        $(".js-options-not-found").show();
      }
    });

    $('.js-price-list-img img').unbind('load');
    $('.js-price-list-img img').on('load', function() {
      $(Proofing_Store.floatingCartOverlay+' ,'+Proofing_Store.floatingCartBlock).addClass('active');
    });
  });

  //WHCC prints standards: 300dpi
  function dpiCheck(oh, ow, asx, asy) {
    // console.log('original_h: '+oh+" original_w: "+ow+" asp_x: "+asx+" asp_y: "+asy);
    if ((asx*300) <= ow && (asy*300) <= oh)
      return true;
    else
      return false;
  }

  function checkAspectRatio(oh, ow, w, h, as) {
    //console.log("In checkAspectRatio: inputs: "+w+", "+h+", "+as);
    var asp = as.toLowerCase().split("x");
    var x, y, priority;
    asp[0] = parseInt(asp[0]);
    asp[1] = parseInt(asp[1]);
    // console.log("height: "+oh+" width: "+ow);
    // console.log("height washuel: "+asp[0]+" width was: "+asp[1]);
    
    if( parseInt(oh) >= parseInt(ow) ) {
      y = ( asp[0] > asp[1] ? asp[0] : asp[1] );
      x = ( asp[0] < asp[1] ? asp[0] : asp[1] );
      priority = "fullheight";
    } else {
      x = ( asp[0] > asp[1] ? asp[0] : asp[1] );
      y = ( asp[0] < asp[1] ? asp[0] : asp[1] );
      priority = "fullwidth";
    }

    // console.log("priority: "+priority);
    // console.log("priority x: "+x);
    // console.log("priority y: "+y);
    
    window.CurrentImage = { large_height : oh, large_width : ow, height: h, width: w };

    w = parseInt(w);
    h = parseInt(h);

    var res = { priority: priority , aspx : x, aspy : y };
    res.status = false;

    if($(".js-printable-check-val").attr('data-photocheck') == 1){
      // console.log("printable 2--");
      if(!dpiCheck(oh, ow, x, y)) {
        res.status = false;
        res.x = -1;
        res.y = -1;
        res.h = -1;
        res.w = -1;
        res.ow = -1;
        res.oh = -1;
        return res;
      }
    }
    // if(!dpiCheck(oh, ow, x, y)) {
    //   res.status = false;
    //   res.x = -1;
    //   res.y = -1;
    //   res.h = -1;
    //   res.w = -1;
    //   res.ow = -1;
    //   res.oh = -1;
    //   return res;
    // }

    if( priority == "fullheight" ) {
      
      // console.log("In fullHeight");

      //=================== 100% height
      res.h = h;
      res.w = Math.round((h*x)/y);
      if (res.w <= w) {
        res.type = "height 100%";
        res.x = Math.round( ( w - res.w ) / 2 );
        res.y = 0;
        res.ow = res.w;
        res.oh = res.h;
        res.w += res.x;
        res.status = true;
        return res;
      }
      //==================== 100% width
      res.w = w;
      res.h = Math.round((w*y)/x);
      if (res.h <= h) {
        res.type = "width 100%";
        res.x = 0;
        res.y = Math.round( ( h - res.h ) / 2 );
        res.oh = res.h;
        res.ow = res.w;
        res.h += res.y;
        res.status = true;
        return res;
      }
    } else {
      // console.log("In fullWidth");
      //==================== 100% width
      res.w = w;
      res.h = Math.round((w*y)/x);
      if (res.h <= h) {
        res.type = "width 100%";
        res.x = 0;
        res.y = Math.round( ( h - res.h ) / 2 );
        res.oh = res.h;
        res.ow = res.w;
        res.h += res.y;
        res.status = true;
        return res;
      }
      //=================== 100% height
      res.h = h;
      res.w = Math.round((h*x)/y);
      if (res.w <= w) {
        res.type = "height 100%";
        res.x = Math.round( ( w - res.w ) / 2 );
        res.y = 0;
        res.ow = res.w;
        res.oh = res.h;
        res.w += res.x;
        res.status = true;
        return res;
      }
    }

    if ($(".js-printable-check-val").attr('data-photocheck') == 0) {
      // console.log("printable 1--");
      if(!dpiCheck(oh, ow, x, y)) {
        res.status = false;
        res.x = x;
        res.y = y;
        res.h = h;
        res.w = w;
        res.ow = ow;
        res.oh = oh;
        return res;
      }
    }



    return res;
    //====================





  }

  Proofing_Store.rotateCrop = function() {
    var item = _JCROP.active;
    var x, y, w, h, priority;
    var res = {};

    // x = ( ( $(item).attr("data-aspy") != "undefined" && parseInt($(item).attr("data-aspy")) > 0 ) ? parseInt($(item).attr("data-aspy")) :  );
    // y = ( ( $(item).attr("data-aspx") != "undefined" && parseInt($(item).attr("data-aspx")) > 0 ) ? parseInt($(item).attr("data-aspx")) :  );
    x = parseInt($(item).attr("data-aspy"));
    y = parseInt($(item).attr("data-aspx"));

    w = _JCROP.img.x;
    h = _JCROP.img.y;

    if(w > h) {
      priority = "fullwidth";
    } else {
      priority = "fullheight";
    }

    if( priority == "fullheight" ) {
      //=================== 100% height
      res.h = h;
      res.w = Math.round((h*x)/y);
      if (res.w <= w) {
        res.type = "height 100%";
        res.x = Math.round( ( w - res.w ) / 2 );
        res.y = 0;
        res.ow = res.w;
        res.oh = res.h;
        res.w += res.x;
        res.status = true;
      }
      //==================== 100% width
      res.w = w;
      res.h = Math.round((w*y)/x);
      if (res.h <= h) {
        res.type = "width 100%";
        res.x = 0;
        res.y = Math.round( ( h - res.h ) / 2 );
        res.oh = res.h;
        res.ow = res.w;
        res.h += res.y;
        res.status = true;
      }
    } else {
      //==================== 100% width
      res.w = w;
      res.h = Math.round((w*y)/x);
      if (res.h <= h) {
        res.type = "width 100%";
        res.x = 0;
        res.y = Math.round( ( h - res.h ) / 2 );
        res.oh = res.h;
        res.ow = res.w;
        res.h += res.y;
        res.status = true;
      }
      //=================== 100% height
      res.h = h;
      res.w = Math.round((h*x)/y);
      if (res.w <= w) {
        res.type = "height 100%";
        res.x = Math.round( ( w - res.w ) / 2 );
        res.y = 0;
        res.ow = res.w;
        res.oh = res.h;
        res.w += res.x;
        res.status = true;
      }
    }

    $(item).attr("data-x", res.x);
    $(item).attr("data-y", res.y);
    $(item).attr("data-h", res.h);
    $(item).attr("data-w", res.w);
    $(item).attr("data-oh", res.oh);
    $(item).attr("data-ow", res.ow);
    $(item).attr("data-aspx", x);
    $(item).attr("data-aspy", y);
    _JCROP.asp = { x : parseFloat($(item).attr('data-aspx')), y : parseFloat($(item).attr('data-aspy')) };

    _JCROP.jcrop.release();
    _JCROP.jcrop.setSelect([res.x, res.y, res.w, res.h]);
  }

  $('body').on('click', Proofing_Store.favGalleryCart, function (event) {
    event.stopPropagation();
    $('body').addClass('no-scroll');
    $('.js-plt').hide();
    $('.js-plt_'+$(this).attr('data-galleryid')).show();
    $('.js-price-list-body').show();
    $('.js-pcart-item-wrapper').hide();
    $('.js-price-list-img').attr('data-imageid', $(this).attr('data-imageid'));
    $('.js-price-list-img').attr('data-galleryid', $(this).attr('data-galleryid'));
    $('.js-price-list-img img').attr('src', $(this).attr('data-smallscreen'));
    var current_image_id = $(this).data('imageid');
    var original_height = $("[data-gridimageid='"+$(this).data('imageid')+"']").attr("data-height");
    var original_width = $("[data-gridimageid='"+$(this).data('imageid')+"']").attr("data-width");
    var height500 = $("[data-gridimageid='"+$(this).data('imageid')+"']").attr("data-height500");
    var width500 = $("[data-gridimageid='"+$(this).data('imageid')+"']").attr("data-width500");
    var h = height500;
    var w = width500;
    var as;

    if (typeof h == 'undefined' || typeof w == 'undefined' || typeof h == '' || typeof w == '') {
      if (typeof original_height != 'undefined' && typeof original_width != 'undefined') {
        w = original_width;
        h = original_height;
        
        newUnit   = 500;
        if ($(this).attr('data-jcropnewimg') == "1") {
          newUnit   = 500;  
        } else{
          newUnit   = 400;
        }
        
        if ( w <= newUnit && h <= newUnit) {
        } else {
          
          if (newUnit == 500) {
            if (w > newUnit) {
              w     =   newUnit;
              h    =  Math.round((newUnit*original_height)/original_width);
            }
          } else {
            if (w > newUnit) {
              w     =   newUnit;
              h    =  Math.round((newUnit*original_height)/original_width);
            }
          }

        }
      }
    }

    // console.log('height: '+h+'width: '+w);
    // console.log('.js-photono-'+$(this).attr('data-imageid'));

    var galleryid = $(".price-list-table:visible").attr('data-galleryid');
    var iterator = $('.js-photono-'+$(this).attr('data-imageid'));
    if(typeof galleryid != "undefined" && galleryid != "" && $('.js-photono-'+$(this).attr('data-imageid')+'[data-galleryid='+galleryid+']').length > 0) {// in case of search blade
      // console.log("search blade");
      iterator = $('.js-photono-'+$(this).attr('data-imageid')+'[data-galleryid='+galleryid+']');
    }
    $.each(iterator, function( key, value ) {
      $that = $(value);
      $.each($('.js-table-tr'), function( key, value ) {
        if( $that.attr('data-optionid') == $(value).attr('data-labelid') ) {
          $(value).find('span').text($that.attr('data-quantity'));
        //=================== function to check if image has jcrop compatible aspect ratio
        //width, height, aspect ratio
        // if( $(this).attr('data-labcatlogid') != 0 ) {
        if( $(this).attr('data-labcatlogid') >= 0 && $(value).attr('data-download') == 0 ) {
          var div = $(value).find('.label-v');
          as = "";
          if( parseFloat($(div).attr("data-height")) > 0 && parseFloat($(div).attr("data-width")) > 0 ) {
            as = $(div).attr("data-width") +" x "+$(div).attr("data-height");
          } else {
            as = $(value).find('.label-v').text();
            if( as.indexOf('8 Up Wallet') !== -1 )
              as = "2.5 x 3.5";
          }
          // console.log("Aspect ratio: "+as);
          var res = checkAspectRatio(original_height, original_width, w, h, as);
          if(res.status) {
            $(value).show();
          } else {
            // $(value).hide();
            if ($that.attr('data-photocheck') == 'js-check-printable-size') {
              $(value).hide();
            }

          }
          // $(value).find('span').attr('data-x', res.x);
          // $(value).find('span').attr('data-y', res.y);
          // $(value).find('span').attr('data-h', res.h);
          // $(value).find('span').attr('data-w', res.w);
          // $(value).find('span').attr('data-oh', res.oh);
          // $(value).find('span').attr('data-ow', res.ow);
          // $(value).find('span').attr('data-aspx', res.aspx);
          // $(value).find('span').attr('data-aspy', res.aspy);
        }
        //=================== End
        }
      });
    });
    // code to hide/show table headings
    $(".js-table-container").each(function(i, v) {
      if($(v).find('.js-table-tr').is(':visible')) {
        $(v).find('.tr-heading').show();        
      } else {
        $(v).find('.tr-heading').hide();
      }
    });




    if($('.js-table-tr').is(':visible')) {
      $(".js-options-not-found").hide();
    } else {
      $(".js-options-not-found").show();
    }

    $('.js-price-list-img img').unbind('load');
    $('.js-price-list-img img').on('load', function() {
      $(Proofing_Store.floatingCartOverlay+' ,'+Proofing_Store.floatingCartBlock).addClass('active');
    });
  });

  $(Proofing_Store.floatingCartClose+' ,'+Proofing_Store.floatingCartOverlay).on('click', function(event) {
    $(Proofing_Store.floatingCartOverlay+' ,'+Proofing_Store.floatingCartBlock).removeClass('active');
    $('body').removeClass('no-scroll');
    $('.js-prod-desc-single-modal, .js-prod-info').removeClass('active');
    $('.js-prod-info').parent().parent('.js-table-tr').removeClass('active');

    $('.js-image-crop-close-btn').click();

  });

  $(Proofing_Store.floatingCartBtn+', .js-pcart-nextstep').unbind('click');
  $('body').on('click', Proofing_Store.floatingCartBtn+', .js-pcart-nextstep', function(event) {
    $(Proofing_Store.floatingCartOverlay+' ,'+Proofing_Store.floatingCartBlock).addClass('active');
    $('.js-price-list-body').hide();
    $('.js-pcart-item-wrapper').show();
    $('body').addClass('no-scroll');
  });

}



_JCROP = {};
_JCROP.init = function() {
  // console.log('Initialize jcrop!');
  function showCoords(c) {
    _JCROP.coor = c;
    getPoints();
  }
  
  jQuery(function($) {
    $('.magic').Jcrop({
      onSelect : showCoords,
      onChange : showCoords,
      setSelect : [_JCROP.boxData.x, _JCROP.boxData.y, _JCROP.boxData.w, _JCROP.boxData.h],
      allowResize : false,
      allowSelect : false,
      boxWidth: 500,   //Maximum width you want for your bigger images
      boxHeight: 550,  //Maximum Height for your bigger images
    }, function() {
      _JCROP.jcrop = this;
    });
  });
}



Proofing_Store.crop_init = function (th) {
    _JCROP.boxData = {};
    _JCROP.active = th;
    _JCROP.boxData.x = $(th).attr('data-x');
    _JCROP.boxData.y = $(th).attr('data-y');
    _JCROP.boxData.h = $(th).attr('data-h');
    _JCROP.boxData.w = $(th).attr('data-w');
    _JCROP.asp = { x : parseFloat($(th).attr('data-aspx')), y : parseFloat($(th).attr('data-aspy')) };

    _JCROP.cartid = $(th).parent().parent().find(Proofing_Store.insideCartQuantity).attr('data-itemid');

    var i = new Image();
    i.className = "magic";
    $('.crop-image-wrapper').html(i);

    if (userObject.isMobile == '1') {
      var src = get500Image($(th).parent().parent().find('img').attr('src'));
    } else {
      var src = get500Image($(th).parent().parent().parent().find('img').attr('src'));
    }

    i.onload = function() {
      _JCROP.img = {};
      _JCROP.img.el = i;
      _JCROP.img.x = i.width;
      _JCROP.img.y = i.height;
      _JCROP.init();
    }
    i.src = src;

}


Proofing_Store.cropModalInit = function() {
  $(Proofing_Store.cropImageBtn).unbind('click');
  $(Proofing_Store.cropImageBtn).on('click', function(event) {

    $(Proofing_Store.cropImage).addClass('image-crop-modal-active bg-white js-crop-modal-bg');
    $(".js-image-crop-body-overlay, .js-image-crop-body").addClass('image-crop-modal-active js-crop-modal-body');
    Proofing_Store.crop_init(this);

    $('body').find('.jcrop-img-view').removeClass('js-update_jcrop');
    $('body').find('.js-cart-item-list').removeClass('js-update_jcrop_bg');
    $(this).parent().parent().siblings('.jcrop-img-view').addClass('js-update_jcrop');
    $(this).parent().parent().parent('.js-cart-item-list').addClass('js-update_jcrop_bg');

  });

  $(Proofing_Store.cropImageCloseBtn).unbind('click');
  $(Proofing_Store.cropImageCloseBtn).on('click', function() {
    $(Proofing_Store.cropImage).removeClass('image-crop-modal-active bg-white js-crop-modal-bg');
    $(".js-image-crop-body-overlay, .js-image-crop-body").removeClass('image-crop-modal-active');
    if($('.magic').length>0) {
      $('.magic').remove();
    }
    if(typeof _JCROP.jcrop != 'undefined') {
      _JCROP.jcrop.destroy(); 
      // console.log('Jcrop destroyed!');
    }

    $('body').find('.jcrop-img-view').removeClass('js-update_jcrop');
    $('body').find('.js-cart-item-list').removeClass('js-update_jcrop_bg');

  });

  $(Proofing_Store.cropCartUpdate).unbind('click');
  $(Proofing_Store.cropCartUpdate).on('click', function() {
    updateCartCoordinates();

    $(function(){
      Proofing_Store.jCropintUpdate();
    });

  });

  $(".js-rotate-crop").unbind('click');
  $(".js-rotate-crop").on('click', function() {
    Proofing_Store.rotateCrop();
  });
}

function get500Image (imgsrc) {
  if (userObject.isMobile == '1') {
    return imgsrc.replace('/100/', '/500/');
  } else{
    return imgsrc.replace('/100/', '/500/');
  }
}

function getP(x,i) {
  return Math.round((x*100)/i);
}

function getPoints() {
  _JCROP.whcc = {};
  var xcenter = Math.round((_JCROP.coor.x+_JCROP.coor.x2)/2);
  var ycenter = Math.round((_JCROP.coor.y+_JCROP.coor.y2)/2);
  _JCROP.whcc.x1 = getP(xcenter, _JCROP.img.x);
  _JCROP.whcc.y1 = getP(ycenter, _JCROP.img.y);
  _JCROP.whcc.x3 = getP(_JCROP.coor.w, _JCROP.img.x);
  _JCROP.whcc.y3 = getP(_JCROP.coor.h, _JCROP.img.y);
  _JCROP.whcc.x2 = 50;
  _JCROP.whcc.y2 = 50;
}

function updateCartCoordinates() {
  if(!_JCROP.cartid || typeof _JCROP.cartid == 'undefined') {
    alert("Item is no longer available in your cart.");
    return false;
  }
  var cartid = _JCROP.cartid;
  var route_arr = $('.js-price-list-body').data('requestslug').split('/');
  route_arr[3] = "update-crop";
  var update_route = route_arr.join('/');
  $.ajax({
    type: 'POST',
    url: update_route+'?_token='+$('#csrf_token').val(),
    data: {
      'cartid': cartid,
      'data_x': _JCROP.coor.x,
      'data_y': _JCROP.coor.y,
      'data_h': parseInt(_JCROP.coor.y + _JCROP.coor.h),
      'data_w': parseInt(_JCROP.coor.x + _JCROP.coor.w),
      'data_oh': parseInt(_JCROP.coor.h),
      'data_ow': parseInt(_JCROP.coor.w),
      'print_width': parseFloat(_JCROP.asp.x),
      'print_height': parseFloat(_JCROP.asp.y),
    }
  })
  .done(function(data) {
    //update data-coordinates
    _JCROP.active.setAttribute('data-x', _JCROP.coor.x);
    _JCROP.active.setAttribute('data-y', _JCROP.coor.y);
    _JCROP.active.setAttribute('data-h', parseInt(_JCROP.coor.y + _JCROP.coor.h));
    _JCROP.active.setAttribute('data-w', parseInt(_JCROP.coor.x + _JCROP.coor.w));
    _JCROP.active.setAttribute('data-oh', parseInt(_JCROP.coor.h));
    _JCROP.active.setAttribute('data-ow', parseInt(_JCROP.coor.w));
    _JCROP.active.setAttribute('data-aspx', parseFloat(_JCROP.asp.x));
    _JCROP.active.setAttribute('data-aspy', parseFloat(_JCROP.asp.y));

    _JCROP.active.parentElement.parentElement.previousElementSibling.setAttribute('data-x', _JCROP.coor.x);
    _JCROP.active.parentElement.parentElement.previousElementSibling.setAttribute('data-y', _JCROP.coor.y);
    _JCROP.active.parentElement.parentElement.previousElementSibling.setAttribute('data-h', parseInt(_JCROP.coor.y + _JCROP.coor.h));
    _JCROP.active.parentElement.parentElement.previousElementSibling.setAttribute('data-w', parseInt(_JCROP.coor.x + _JCROP.coor.w));
    _JCROP.active.parentElement.parentElement.previousElementSibling.setAttribute('data-oh', parseInt(_JCROP.coor.h));
    _JCROP.active.parentElement.parentElement.previousElementSibling.setAttribute('data-ow', parseInt(_JCROP.coor.w));
    _JCROP.active.parentElement.parentElement.previousElementSibling.setAttribute('data-aspx', parseFloat(_JCROP.asp.x));
    _JCROP.active.parentElement.parentElement.previousElementSibling.setAttribute('data-aspy', parseFloat(_JCROP.asp.y));

    // sweetAlert('Cropped Image coordinates updated');
    // swal({
    //   title: "Crop area has been updated",
    //   text: "",
    //   customClass: 'image-crop-alert',
    //   confirmButtonText: "OK",
    //   allowOutsideClick: false,
    // });

    var n = noty($.extend({
      text        : window.labels != 'undefined' ? window.labels.crop_area_has_been_updated : 'Crop area has been updated',
      type        : 'success',
      template    : '<div class="noty_message"><span class="noty_text"></span><div class="noty_close"></div></div>',
      timeout     :  4000,
    }, window.notyDefaults));



  });
}



Proofing_Store.jCropint = function() {
  $(".jcrop-img-view img").each(function() {
    var x = $(this).parents('.jcrop-img-view').attr('data-x');
    var y = $(this).parents('.jcrop-img-view').attr('data-y');
    var h = $(this).parents('.jcrop-img-view').attr('data-h');
    var w = $(this).parents('.jcrop-img-view').attr('data-w');
    var aspx = parseFloat($(this).parents('.jcrop-img-view').attr('data-aspx'));
    var aspy = parseFloat($(this).parents('.jcrop-img-view').attr('data-aspy'));
    // console.log(x, y, h, w, aspx / aspy);
    $(this).Jcrop({
      // onSelect:    showCoords,
      bgColor:     'black',
      bgOpacity:   .4,
      setSelect:   [ x, y, h, w ],
      aspectRatio: aspx / aspy,
      allowResize : false,
      allowSelect : false,
      boxWidth: 70, boxHeight: 105,
      // boxWidth: w, boxHeight: h,
      trueSize: [w,h]
    });
  });
};


Proofing_Store.jCropintUpdate = function() {    
  setTimeout( function (){
    var x = $('.js-update_jcrop').attr('data-x');
    var y = $('.js-update_jcrop').attr('data-y');
    var h = $('.js-update_jcrop').attr('data-h');
    var w = $('.js-update_jcrop').attr('data-w');
    var aspx = parseFloat($('.js-update_jcrop').attr('data-aspx'));
    var aspy = parseFloat($('.js-update_jcrop').attr('data-aspy'));
    // console.log(x, y, h, w, aspx / aspy);
    // console.log("img icons- update crop");
    $('.js-update_jcrop img').Jcrop({
      // onSelect:    showCoords,
      bgColor:     'black',
      bgOpacity:   .4,
      setSelect:   [ x, y, h, w ],
      aspectRatio: aspx / aspy,
      allowResize : false,
      allowSelect : false,
      boxWidth: 70, boxHeight: 105,
      trueSize: [w,h]
    });
    // console.log("img icons- update crop done");
  },1000);
};

